<body>
  <h1>Presents....</h1>
  
  <p>Hi {{user.displayName}}! Logged in? {{isLoggedIn}}</p>
  <button (click)="logout()">Logout</button>
  
  <div>
    <h2>Add data</h2>

    <form #addDataForm="ngForm" (ngSubmit)="addData(addDataForm.value)">

        <label for="who-from">Who was the present from?</label>
        <input
          id="who-from"
          type="text"
          ngModel
          #whoFrom="ngModel"
          name="whoFrom"
          required
        >
        <div *ngIf="whoFrom.touched && whoFrom.invalid">
            Required
        </div>
    
        <label for="who-to">Who was the present for?</label>
        <input
          id="who-to"
          type="text"
          ngModel
          #whoTo="ngModel"
          name="whoTo"
          required
        >
        <div *ngIf="whoTo.touched && whoTo.invalid">
          Required
        </div>
    
        <label for="what-it-was">What was the present?</label>
        <textarea
          id="what-it-was"
          type="text"
          ngModel
          #whatItWas="ngModel"
          name="whatItWas"
          rows="3"
          required
        ></textarea>
        <div *ngIf="whatItWas.touched && whatItWas.invalid">
          Required
        </div>
    
        <label for="picture">Upload a picture</label>
        <input
          id="picture"
          type="text"
          ngModel
          #picture="ngModel"
          name="picture"
          required
        >
    
        <label for="rating">Rate the present out of 5</label>
        <input
          id="rating"
          type="range"
          ngModel
          #rating="ngModel"
          name="rating"
          min="0" max="5"
          required
        >
        <div *ngIf="rating.touched && rating.invalid">
          Required
        </div>
      
        <button type="submit">Add</button>
      
      </form>    

  </div>

  <div>
    <h2>Current data</h2>

    <div *ngFor="let present of presents | async" class="present">
      <p> Present: {{present.whatItWas}} </p>
      <p> Picture is of: {{present.picture}} </p>
      <p> From {{present.whoFrom}} to {{present.whoTo}} </p>
      <p> Present rating: {{present.rating}} </p>
      <p> Thanked? {{present.thanked}} </p>

      <button (click)="showHideUpdateForm(present)">Edit info</button>
      <button (click)="deletePresent(present.id)">Delete</button>
      

      <form #updateForm="ngForm" (ngSubmit)="updateData(updateForm.value, present)" [hidden]="present.hideEdit">

          <label for="who-from-update">Who was the present from?</label> 
          <input
            id="who-from-update"
            type="text"
            [(ngModel)]="present.whoFrom"
            #whoFromUpdate="ngModel"
            name="whoFrom"
            required
          >
          <div *ngIf="whoFromUpdate.touched && whoFromUpdate.invalid">
            Required
          </div>
      
          <label for="who-to-update">Who was the present for?</label>
          <input
            id="who-to-update"
            type="text"
            [(ngModel)]="present.whoTo"
            #whoToUpdate="ngModel"
            name="whoTo"
            required
          >
          <div *ngIf="whoToUpdate.touched && whoToUpdate.invalid">
            Required
          </div>
      
          <label for="what-it-was-update">What was the present?</label>
          <textarea
            id="what-it-was-update"
            type="text"
            [(ngModel)]="present.whatItWas"
            #whatItWasUpdate="ngModel"
            name="whatItWas"
            rows="3"
            required
          ></textarea>
          <div *ngIf="whatItWasUpdate.touched && whatItWasUpdate.invalid">
            Required
          </div>
      
          <label for="picture-update">Upload a picture</label>
          <input
            id="picture-update"
            type="text"
            [(ngModel)]="present.picture"
            #picture="ngModel"
            name="picture"
            required
          >
      
          <label for="rating-update">Rate the present out of 5</label>
          <input
            id="rating-update"
            type="range"
            [(ngModel)]="present.rating"
            #ratingUpdate="ngModel"
            name="rating"
            min="0" max="5"
            required
          >
          <div *ngIf="ratingUpdate.touched && ratingUpdate.invalid">
            Required
          </div>

          <p>{{present | json}}</p>

          <button type="submit" [disabled]="updateForm.form.invalid">Update</button>
          
      </form>

      <button (click)="showHideUpdateForm(present)" [hidden]="present.hideEdit">Cancel</button>


    </div>


  </div>


</body>
